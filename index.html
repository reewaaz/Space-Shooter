<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Alien Invasion Shooter</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  overflow: hidden;
  touch-action: none;
  font-family: system-ui, sans-serif;
}

canvas {
  display: block;
}

#ui {
  position: fixed;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 16px;
  z-index: 10;
}

#fireBtn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 70px;
  height: 70px;
  border-radius: 50%;
  background: rgba(255,255,255,0.15);
  border: 2px solid white;
  color: white;
  font-size: 14px;
}
</style>
</head>
<body>

<div id="ui">
  Score: <span id="score">0</span><br />
  Lives: <span id="lives">3</span>
</div>

<button id="fireBtn">FIRE</button>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

let score = 0;
let lives = 3;

const player = {
  x: canvas.width / 2,
  y: canvas.height - 80,
  r: 20,
  speed: 6
};

let bullets = [];
let aliens = [];
let explosions = [];

function spawnAlien() {
  aliens.push({
    x: Math.random() * (canvas.width - 40) + 20,
    y: -30,
    r: 18,
    speed: 1 + Math.random() * 1.5
  });
}

setInterval(spawnAlien, 800);

function shoot() {
  bullets.push({
    x: player.x,
    y: player.y - 20,
    r: 4,
    speed: 8
  });
}

document.getElementById("fireBtn").addEventListener("touchstart", shoot);
document.getElementById("fireBtn").addEventListener("mousedown", shoot);

let touchX = null;

canvas.addEventListener("touchstart", e => {
  touchX = e.touches[0].clientX;
});

canvas.addEventListener("touchmove", e => {
  if (touchX !== null) {
    const dx = e.touches[0].clientX - touchX;
    player.x += dx * 0.1;
    touchX = e.touches[0].clientX;
  }
});

canvas.addEventListener("touchend", () => {
  touchX = null;
});

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Player
  ctx.fillStyle = "cyan";
  ctx.beginPath();
  ctx.moveTo(player.x, player.y - player.r);
  ctx.lineTo(player.x - player.r, player.y + player.r);
  ctx.lineTo(player.x + player.r, player.y + player.r);
  ctx.closePath();
  ctx.fill();

  // Bullets
  ctx.fillStyle = "yellow";
  bullets.forEach((b, i) => {
    b.y -= b.speed;
    ctx.beginPath();
    ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
    ctx.fill();
    if (b.y < 0) bullets.splice(i, 1);
  });

  // Aliens
  ctx.fillStyle = "lime";
  aliens.forEach((a, ai) => {
    a.y += a.speed;
    ctx.beginPath();
    ctx.arc(a.x, a.y, a.r, 0, Math.PI * 2);
    ctx.fill();

    if (a.y > canvas.height) {
      aliens.splice(ai, 1);
      lives--;
      document.getElementById("lives").textContent = lives;
      if (lives <= 0) gameOver();
    }

    bullets.forEach((b, bi) => {
      const dx = a.x - b.x;
      const dy = a.y - b.y;
      if (Math.sqrt(dx*dx + dy*dy) < a.r + b.r) {
        aliens.splice(ai, 1);
        bullets.splice(bi, 1);
        explosions.push({x:a.x,y:a.y,r:0});
        score += 10;
        document.getElementById("score").textContent = score;
      }
    });
  });

  // Explosions
  ctx.strokeStyle = "orange";
  explosions.forEach((ex, i) => {
    ex.r += 2;
    ctx.beginPath();
    ctx.arc(ex.x, ex.y, ex.r, 0, Math.PI * 2);
    ctx.stroke();
    if (ex.r > 30) explosions.splice(i, 1);
  });

  requestAnimationFrame(update);
}

function gameOver() {
  ctx.fillStyle = "white";
  ctx.font = "32px sans-serif";
  ctx.textAlign = "center";
  ctx.fillText("GAME OVER", canvas.width / 2, canvas.height / 2);
  ctx.font = "18px sans-serif";
  ctx.fillText("Refresh to play again", canvas.width / 2, canvas.height / 2 + 40);
  throw new Error("Game Over");
}

update();
</script>

</body>
</html>